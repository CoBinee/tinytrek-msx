; resources/basic/tinytrek.bas
;

    .module autoexec
    .area   _CODE

_autoexec::

    .ascii  "  5 Y=2999;IN.\042DO YOU WANT A DIFFICULT GAME?  \042,\042(Y OR N)\042A\n"
    .ascii  " 10 PR.\042STARDATE 3200:  YOUR MISSION IS \042,;IFA=YY=999\n"
    .ascii  " 15 K=0,B=0,D=30;F.I=0TO63;J=R.(99)<5,B=B+J\n"
    .ascii  " 20 M=R.(Y),M=(M<209)+(M<99)+(M<49)+(M<24)+(M<9)+(M<2),K=K+M\n"
    .ascii  " 25 @(I)=-100*M-10*J-R.(8);N.I;IF(B<2)+(K<4)G.15\n"
    .ascii  " 30 PR.\042TO DESTROY \042,#1,K,\042 KLINGONS IN 30 STARDATES.\n"
    .ascii  " 35 PR.\042THERE ARE \042,#1,B,\042 STARBASES.\042;GOS.160;C=0,H=K\n"
    .ascii  " 40 U=R.(8),V=R.(8),X=R.(8),Y=R.(8)\n"
    .ascii  " 45 F.I=71TO152;@(I)=0;N.I;@(8*X+Y+62)=4,M=A.(@(8*U+V-9)),N=M/100\n"
    .ascii  " 50 I=1;IFNF.J=1TON;GOS.165;@(J+134)=300,@(J+140)=S,@(J+146)=T;N.J\n"
    .ascii  " 55 GOS.175;M=M-100*N,I=2;IFM/10GOS.165\n"
    .ascii  " 60 M=M-M/10*10,I=3;IFMF.J=1TOM;GOS.165;N.J\n"
    .ascii  " 65 GOS.145;GOS.325;IFKG.95\n"
    .ascii  " 70 PR.;PR.\042MISSION ACCOMPLISHED.\042;IFD<3PR.\042BOY, YOU BARELY MADE IT. \n"
    .ascii  " 75 IFD>5PR.\042GOOD WORK...\042;IFD>9PR.\042FANTASTIC!\042;IFD>13PR.\042UNBELIEVABLE!\n"
    .ascii  " 80 D=30-D,I=H*100/D*10;PR.#1,H,\042 KLINGONS IN \042,D,\042 STARDATES. (\042,I,\042)\n"
    .ascii  " 85 J=100*(C=0)-5*C;PR.#1,C,\042 CASUALTIES INCURRED. (\042,J,\042)\n"
    .ascii  " 90 PR.\042YOUR SCORE:\042,I+J;G.110\n"
    .ascii  " 95 IFD<0PR.\042IT'S TOO LATE, THE FEDERATION HAS BEEN CONQUERED.\042;G.110\n"
    .ascii  "100 IFE>=0G.120\n"
    .ascii  "105 PR.\042ENTERPRISE DESTROYED\042;IFH-K>9PR.\042BUT YOU WERE A GOOD MAN\n"
    .ascii  "110 Y=987;PR.;IN.\042ANOTHERE GAME?  \042,\042(Y OR N)\042A;IFA=YG.5\n"
    .ascii  "115 PR.\042GOOD BYE.\042;STOP\n"
    .ascii  "120 S=220,G=180,L=200,P=260,R=420,W=465,T=555;IN.\042CAPTAIN\042A\n"
    .ascii  "125 IF(A=S)+(A=G)+(A=L)+(A=P)+(A=R)+(A=W)+(A=T)G.A\n"
    .ascii  "130 PR.\042R=REPORT       S=SR. SENSOR   L=LR. SENSOR\n"
    .ascii  "135 PR.\042G=GALAXY MAP   P=PHASER       T=TORPEDO\n"
    .ascii  "140 PR.\042W=WARP ENGINE  **PLEASE USE ONE OF THESE COMMANDS***\042;G.120\n"
    .ascii  "145 F.I=X-(X>1)TOX+(X<8);F.J=Y-(Y>1)TOY+(Y<8)\n"
    .ascii  "150 IF@(8*I+J+62)#2N.J;N.I;O=0;R.\n"
    .ascii  "155 IFO=0PR.'SULU: \042CAPTAIN, WE ARE DOCKED AT STARBASE.\042\n"
    .ascii  "160 E=4000,F=10,O=1;F.I=64TO70;@(I)=0;N.I;R.\n"
    .ascii  "165 S=R.(8),T=R.(8),A=8*S+T+62;IF@(A)G.165\n"
    .ascii  "170 @(A)=I;R.\n"
    .ascii  "175 PR.\042ENTERPRISE IN Q-\042,#1,U,V,\042 S-\042,X,Y;R.\n"
    .ascii  "180 GOS.175;J=2;GOS.375;IFIG.120\n"
    .ascii  "185 PR.\042 OF GALAXY MAP\042;F.I=0TO7;PR.;PR.#1,I+1,\042:\042,;F.J=0TO7;M=@(8*I+J)\n"
    .ascii  "190 PR.#4,(M>0)*M,;N.J;PR.;N.I;PR.\042  \042,;F.I=0TO7;PR.\042  ..\042,;N.I;PR.\n"
    .ascii  "195 PR.\042  \042,;F.I=1TO8;PR.#4,I,;N.I;PR.;PR.;G.120\n"
    .ascii  "200 GOS.175;J=3;GOS.375;IFIG.120\n"
    .ascii  "205 PR.;F.I=U-1TOU+1;F.J=V-1TOV+1;M=8*I+J-9,A=0\n"
    .ascii  "210 IF(I>0)*(I<9)*(J>0)*(J<9)A=A.(@(M)),@(M)=A\n"
    .ascii  "215 PR.#4,A,;N.J;PR.;N.I;G.120\n"
    .ascii  "220 GOS.175;J=1;GOS.375;IFIG.120\n"
    .ascii  "225 M=8*U+V-9,@(M)=A.(@(M))\n"
    .ascii  "230 PR.;F.I=1TO8;PR.#1,I,;F.J=1TO8;M=@(8*I+J+62);IFM=0PR.\042 .\042,\n"
    .ascii  "235 IFM=1PR.\042 K\042,\n"
    .ascii  "240 IFM=2PR.\042 B\042,\n"
    .ascii  "245 IFM=3PR.\042 *\042,\n"
    .ascii  "250 IFM=4PR.\042 E\042,\n"
    .ascii  "255 N.J;PR.;N.I;PR.\042 \042,;F.I=1TO8;PR.#2,I,;N.I;PR.;G.120\n"
    .ascii  "260 J=4;GOS.375;IFIG.120\n"
    .ascii  "265 IN.\042 ENERGIZED. \042,\042UNITS TO FIRE\042A;IFA<1G.120\n"
    .ascii  "270 IFA>EPR.'SPOCK: \042WE HAVE ONLY ',#1,E,' UNITS.\042';G.120\n"
    .ascii  "275 E=E-A;IFN<1PR.\042PHASER FIRED AT EMPTY SPACE.\042;G.65\n"
    .ascii  "280 A=A/N;F.M=135TO140;IF@(M)=0G.290\n"
    .ascii  "285 GOS.295;PR.#3,S,\042 UNITS HIT \042,;GOS.305\n"
    .ascii  "290 N.M;G.65\n"
    .ascii  "295 IFA>1090PR.\042...OVERLOADED..\042;J=4,@(67)=1,A=9;GOS.375\n"
    .ascii  "300 I=@(M+6)-X,J=@(M+12)-Y,S=A*30/(30+I*I+J*J)+1;R.\n"
    .ascii  "305 PR.\042KLINGON AT S-\042,#1,@(M+6),@(M+12),;@(M)=@(M)-S\n"
    .ascii  "310 IF@(M)>0PR.\042 **DAMAGED**\042;R.\n"
    .ascii  "315 @(M)=0,I=8*U+V-9,J=@(I)/A.(@(I)),@(I)=@(I)-100*J,K=K-1\n"
    .ascii  "320 I=8*@(M+6)+@(M+12)+62,@(I)=0,N=N-1;PR.\042 ***DESTROYED***\042;R.\n"
    .ascii  "325 IFN=0R.\n"
    .ascii  "330 PR.\042KLINGON ATTACK\042;IFOPR.\042STARBASE PROTECTS ENTERPRISE\042;R.\n"
    .ascii  "335 T=0;F.M=135TO140;IF@(M)=0G.350\n"
    .ascii  "340 A=(@(M)+R.(@(M)))/2;GOS.295;T=T+S,I=@(M+6),J=@(M+12)\n"
    .ascii  "345 PR.#3,S,\042 UNITS HIT FROM KLINGON AT S-\042,#1,I,J\n"
    .ascii  "350 N.M;E=E-T;IFE<=0PR.\042*** BANG ***\042;R.\n"
    .ascii  "355 PR.#1,E,\042 UNITS OF ENERGY LEFT.\042;IFR.(E/4)>TR.\n"
    .ascii  "360 IF@(70)=0@(70)=R.(T/50+1),J=7;G.375\n"
    .ascii  "365 J=R.(6),@(J+63)=R.(T/99+1)+@(J+63),I=R.(8)+1,C=C+I\n"
    .ascii  "370 PR.'MC COY: \042SICKBAY TO BRIDGE, WE SUFFERED',#2,I,' CASUALTIES.\042\n"
    .ascii  "375 I=@(J+63);IFJ=1PR.\042SHORT RANGE SENSOR\042,\n"
    .ascii  "380 IFJ=2PR.\042COMPUTER DISPLAY\042,\n"
    .ascii  "385 IFJ=3PR.\042LONG RANGE SENSOR\042,\n"
    .ascii  "390 IFJ=4PR.\042PHASER\042,\n"
    .ascii  "395 IFJ=5PR.\042WARP ENGINE\042,\n"
    .ascii  "400 IFJ=6PR.\042PHOTON TORPEDO TUBES\042,\n"
    .ascii  "405 IFJ=7PR.\042SHIELD\042,\n"
    .ascii  "410 IFI=0R.\n"
    .ascii  "415 PR.\042 DAMAGED, \042,#1,I,\042 STARDATES ESTIMATED FOR REPAIR\042;R.\n"
    .ascii  "420 PR.\042STATUS REPORT:\042;PR.\042STARDATE\042,#10,3230-D;PR.\042TIME LEFT\042,#7,D\n"
    .ascii  "425 PR.\042CONDITION     \042,;IFOPR.\042DOCKED\042;G.445\n"
    .ascii  "430 IFNPR.\042RED\042;G.445\n"
    .ascii  "435 IFE<999PR.\042YELLOW\042;G.445\n"
    .ascii  "440 PR.\042GREEN\n"
    .ascii  "445 PR.\042POSITION      Q-\042,#1,U,V,\042 S-\042,X,Y;PR.\042ENERGY\042,#12,E\n"
    .ascii  "450 PR.\042TORPEDOES\042,#7,F;PR.\042KLINGONS LEFT\042,#3,K;PR.\042STARBASES\042,#6,B\n"
    .ascii  "455 F.J=1TO7;IF@(J+63)GOS.375\n"
    .ascii  "460 N.J;G.120\n"
    .ascii  "465 J=5;GOS.375;IFI=0PR.\n"
    .ascii  "470 IN.\042SECTOR DISTANCE\042W;IFW<1G.120\n"
    .ascii  "475 IFI*(W>2)PR.'CHEKOV: \042WE CAN TRY 2 AT MOST, SIR.\042';G.470\n"
    .ascii  "480 IFW>91W=91;PR.'SPOCK: \042ARE YOU SURE, CAPTAIN?\042\n"
    .ascii  "485 IFE<W*W/2PR.'SCOTTY: \042SIR, WE DO NOT HAVE THE ENERGY.\042';G.120\n"
    .ascii  "490 GOS.615;IFR=0G.120\n"
    .ascii  "495 D=D-1,E=E-W*W/2,@(8*X+Y+62)=0\n"
    .ascii  "500 F.M=64TO70;@(M)=(@(M)-1)*(@(M)>0);N.M\n"
    .ascii  "505 P=45*X+22,G=45*Y+22,W=45*W;F.M=1TO8;W=W-R;IFW<-22G.525\n"
    .ascii  "510 P=P+S,G=G+T,I=P/45,J=G/45;IF(I<1)+(I>8)+(J<1)+(J>8)G.530\n"
    .ascii  "515 IF@(8*I+J+62)=0X=I,Y=J;N.M\n"
    .ascii  "520 PR.\042**EMERGENCY STOP**\042;PR.'SPOCK: \042TO ERR IS HUMAN.\042\n"
    .ascii  "525 @(8*X+Y+62)=4;GOS.175;G.65\n"
    .ascii  "530 P=U*72+P/5+W/5*S/R-9,U=P/72,G=V*72+G/5+W/5*T/R-9,V=G/72\n"
    .ascii  "535 IFR.(9)<2PR.\042***SPACE STORM***\042;T=100;GOS.360\n"
    .ascii  "540 IF(U>0)*(U<9)*(V>0)*(V<9)X=(P+9-72*U)/9,Y=(G+9-72*V)/9;G.45\n"
    .ascii  "545 PR.\042**YOU WANDERED OUTSIDE THE GALAXY**\n"
    .ascii  "550 PR.\042ON BOARD COMPUTER TAKES OVER, AND SAVED YOUR LIFE\042;G.40\n"
    .ascii  "555 J=6;GOS.375;IFIG.120\n"
    .ascii  "560 IFF=0PR.\042 EMPTY\042;G.120\n"
    .ascii  "565 PR.\042 LOADED\042;GOS.615;IFR=0G.120\n"
    .ascii  "570 PR.\042TORPEDO TRACK \042,;F=F-1,P=45*X+22,G=45*Y+22;F.M=1TO8\n"
    .ascii  "575 P=P+S,G=G+T,I=P/45,J=G/45;IF(I<1)+(I>8)+(J<1)+(J>8)G.585\n"
    .ascii  "580 L=8*I+J+62,W=8*U+V-9,R=@(W)/A.(@(W));PR.#1,I,J,\042 \042,;G.585+5*@(L)\n"
    .ascii  "585 N.M;PR.\042...MISSED\042;G.65\n"
    .ascii  "590 S=R.(99)+280;F.M=135TO140;IF(@(M+6)=I)*(@(M+12)=J)GOS.305\n"
    .ascii  "592 N.M;G.65\n"
    .ascii  "595 B=B-1,@(L)=0,@(W)=@(W)-10*R;PR.\042STARBASE DESTROYED\n"
    .ascii  "597 PR.'SPOCK: \042I OFTEN FIND HUMAN BEHAVIOUR FASCINATING.\042';G.65\n"
    .ascii  "600 PR.\042HIT A STAR\042;IFR.(9)<3PR.\042TORPEDO ABSORBED\042;G.65\n"
    .ascii  "605 @(L)=0,@(W)=@(W)-R;IFR.(9)<6PR.\042STAR DESTROYED\042;G.65\n"
    .ascii  "610 T=300;PR.\042IT NOVAS    ***RADIATION ALARM***\042;GOS.360;G.65\n"
    .ascii  "615 IN.\042COURSE (0-360)\042I;IF(I>360)+(I<0)R=0;R.\n"
    .ascii  "620 S=(I+45)/90,I=I-S*90,R=(45+I*I)/110+45;G.625+5*(S<4)*S\n"
    .ascii  "625 S=-45,T=I;R.\n"
    .ascii  "630 S=I,T=45;R.\n"
    .ascii  "635 S=45,T=-I;R.\n"
    .ascii  "640 S=-I,T=-45;R.\n"
    .db     0x00


